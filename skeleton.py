class GestureSkeleton:
    def __init__(self, joints, bones):
        self.joints = joints
        self.bones = bones
    
    def landmarks(self):
        indices = [0, 3, 8, 12, 16, 20] # sequence of (root, thumb-tip, index-tip, mid-tip, ring-tip, tail-tip)
        return [self.joints for i in indices]
    
    def to_poly(self):
        header = """
ply
format ascii 1.0
comment VCGLIB generated
element vertex 21
property float x
property float y
property float z
element edge 20                        
property int vertex1                  
property int vertex2
end_header
        """
        print(header)
        for joint in self.joints:
            print("{} {} {}".format(joint[0], joint[1], joint[2]))
        for bone in self.bones:
            print("{} {}".format(bone[0], bone[1]))


joints = [(3.59132538e+001, 1.68612534e+002, 1.16596039e+002), # root
(7.63377714e+000, 1.32244965e+002, 9.73752594e+001), # thumb
(-1.71021042e+001, 1.11684235e+002, 8.60658569e+001),
(-3.38510590e+001, 1.06871048e+002, 8.28839264e+001),
(5.36757507e+001, 1.49244339e+002, 6.10547371e+001), # palm

(2.75827065e+001, 1.37559509e+002, 4.00991020e+001), # index
(1.21351233e+001, 1.30891052e+002, 5.68459213e-001),
(3.44889998e+000, 1.23058754e+002, -2.05836754e+001),
(-1.68075347e+000, 1.17853134e+002, -3.12637157e+001),

(4.92181473e+001, 1.41134644e+002, 3.71231117e+001), # mid
(4.37520027e+001, 1.33780197e+002, -1.01982565e+001),
(4.01115303e+001, 1.24692520e+002, -3.68963814e+001),
(3.79320564e+001, 1.19040787e+002, -4.97129326e+001),

(7.11811218e+001, 1.45844818e+002, 4.09556122e+001), # ring
(7.51204987e+001, 1.37602173e+002, -2.78003240e+000),
(7.70320969e+001, 1.26515182e+002, -2.80945606e+001),
(7.74164658e+001, 1.19449471e+002, -4.01772537e+001),

(9.11662521e+001, 1.47340469e+002, 4.84945297e+001), # tail
(1.04103027e+002, 1.38914871e+002, 1.66838074e+001),
(1.10323257e+002, 1.29622986e+002, 6.36486173e-001),
(1.13671417e+002, 1.22172630e+002, -9.27077770e+000)]

bones = [
    (0,1),(1,2),(2,3), # thumb
    (0,4), # palm
    (4,5), (5,6), (6,7), (7,8), # index
    (4,9), (9,10), (10,11), (11,12), # mid
    (4,13), (13,14), (14,15), (15,16), # ring
    (4,17), (17,18), (18,19), (19,20), # tail
]

reference_skeleton = GestureSkeleton(
    joints, bones
)

target_landmarks = [
    (8.12371521e+001, 1.84513382e+002, 3.47723808e+001), # root
    (6.49874573e+001, 1.76205673e+002, -5.44945831e+001), # thumb
    (1.02906494e+002, 1.77846603e+002, -1.06827469e+002), # index
    (9.12710915e+001, 1.38686005e+002, -4.284644e+001), # mid
    (1.0498917e+002, 1.18785019e+002, -4.24748642e+001), # ring
    (1.47997345e+002, 1.29504944e+002, -7.94640121e+001), # tail
]